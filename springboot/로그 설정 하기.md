## `@Slf4j`의 정체는 뭘까?

우리가 흔히 쓰는 `@Slf4j`는 어떻게 로그를 찍는지 궁금해본 적 있을까?

slf4j의 뜻을 찾아보면 아래와 같이 나온다. 

> The Simple Logging Facade for Java

퍼사드 패턴이란 결국 상위에 추상화 계층을 두는 것이며, 하위에는 이를 구현하는 객체들이 존재한다.

slf4j도 결국 추상화 계층이며, 이를 실제로 구현하는 것은 `logback`이라고 보면 된다.(spring boot default 설정)

<MessageBox title='' level='info'>
  참고로, `@Slf4j`를 클래스 이름 위에 붙이는 것만으로 `log` 변수를 접근할 수 있는 이유는 IDE가 제공하는 편리함 덕분이다.

  빌드 과정 중 컴파일 단계에서 `AST`를 구성하는 과정이 있다. 
  
  자바 코드를 컴파일하기 위해 자바 키워드를 토큰화하여 트리로 만들어주는 과정이다.

  이 과정에서 `lombok`은 `@Slf4j`를 붙은 클래스를 발견하면 logback의 logger 객체를 멤버 변수로 넣어준다.

  <br /><br />
  <a href='https://leejaengjaeng.tistory.com/17' target='_blank'>참고</a>
</MessageBox>

## Sl4fj 설정하기

Sl4fj 설정은 결국 logback 설정을 의미한다.

resources/logback-spring.xml 파일을 생성하고, 이 파일 안에서 설정한다.(파일 이름이 중요하다)

아래는 콘솔에 출력되는 로그에 대해 패턴과 컬러를 설정했다.

```xml
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <appender name="STDOUT"
              class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%boldMagenta(%d{MM-dd HH:mm:ss}) [%boldYellow(%-5level)] %cyan(%logger{5}.%M):%yellow(%line) - %msg %n</pattern>
        </encoder>
    </appender>

    <root level="INFO">
        <appender-ref ref="STDOUT" />
    </root>
</configuration>
```

![image](https://github.com/codeleeks/blog/assets/166087781/ed02499e-660b-47a1-a77b-b1a83fa3a64d)


### 패턴

```
- %logger: 패키지 포함 클래스 정보
- %logger{0}: 패키지를 제외한 클래스 이름만 출력
- %logger{length}: Logger name을 축약할 수 있음. {length}는 최대 자리 수, ex)logger{35}
- %-5level: 로그 레벨, -5는 출력의 고정폭 값(5글자), 로깅레벨이info일 경우 빈칸 하나 추가
- ${PID:-}: 프로세스 아이디
- %d: 로그 기록시간 출력
- %p: 로깅 레벨 출력
- %F: 로깅이 발생한 프로그램 파일명 출력
- %M: 로깅일 발생한 메소드의 명 출력
- %line: 로깅이 발생한 호출지의 라인
- %L: 로깅이 발생한 호출지의 라인
- %thread: 현재 Thread 명
- %t: 로깅이 발생한 Thread 명
- %c: 로깅이 발생한 카테고리
- %C: 로깅이 발생한 클래스 명 (%C{2}는 somePackage.SomeClass 가 출력됨)
- %m: 로그 메시지
- %msg: - 로그 메시지 (=%message)
- %n: 줄바꿈(new line)
- %%: %를 출력
- %r : 애플리케이션 시작 이후부터 로깅이 발생한 시점까지의 시간(ms)
- %d{yyyy-MM-dd-HH:mm:ss:sss}: %d는 date를 의미하며 중괄호에 들어간 문자열은 dateformat을 의미. 따라서 [2021-07-12 12:42:78]과 같은 날짜가 로그에 출력됨.
- %-4relative:  %relative는 초 아래 단위 시간(밀리초)을 나타냄. -4를하면 4칸의 출력폼을 고정으로 가지고 출력. 따라서 숫자에 따라 [2021-07-12 12:42:78:232] 혹은 [2021-07-12 12:42:78:2332]와 같이 표현됨
```

<a href='https://livenow14.tistory.com/64' target='_blank'>참고</a>

<a href='https://letsplaycoding.tistory.com/15' target='_blank'>참고</a>

<a href='https://logback.qos.ch/faq.html#configFileLocation' target='_blank'>공식 독스(읽기 좀 힘듦...)</a>


